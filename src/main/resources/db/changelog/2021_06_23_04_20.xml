<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    <changeSet author="LinhLH276 (generated)" id="1624422032946-10">
        <sql>
            -- ----------------------------
            -- Table structure for access_token
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."access_token";
            CREATE TABLE "public"."access_token" (
            "token" varchar(400) COLLATE "pg_catalog"."default" NOT NULL,
            "created_by" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "created_at" timestamp(6),
            "last_modified_by" varchar(50) COLLATE "pg_catalog"."default",
            "last_modified_at" timestamp(6),
            "expired" bool,
            "expired_date" timestamp(6),
            "username" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "user_id" int8
            )
            ;

            -- ----------------------------
            -- Table structure for file_entry
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."file_entry";
            CREATE TABLE "public"."file_entry" (
            "id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "created_by" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "created_at" timestamp(6),
            "last_modified_by" varchar(50) COLLATE "pg_catalog"."default",
            "last_modified_at" timestamp(6),
            "class_name" varchar(100) COLLATE "pg_catalog"."default",
            "class_pk" int8,
            "content_type" varchar(255) COLLATE "pg_catalog"."default",
            "description" varchar(500) COLLATE "pg_catalog"."default",
            "name" varchar(50) COLLATE "pg_catalog"."default",
            "original_name" varchar(255) COLLATE "pg_catalog"."default",
            "size" int8,
            "folder_id" int8
            )
            ;
            COMMENT ON COLUMN "public"."file_entry"."id" IS 'Bảng lưu thông tin file upload lên hệ thống';
            COMMENT ON COLUMN "public"."file_entry"."class_name" IS 'Tên entity sử dụng file';
            COMMENT ON COLUMN "public"."file_entry"."class_pk" IS 'entityId sử dụng file';
            COMMENT ON COLUMN "public"."file_entry"."content_type" IS 'MIME type của file, e.g image/gif';
            COMMENT ON COLUMN "public"."file_entry"."name" IS 'Tên của file sau khi upload lên hệ thống, có thể đc mã hóa';
            COMMENT ON COLUMN "public"."file_entry"."original_name" IS 'Tên gốc của file';
            COMMENT ON COLUMN "public"."file_entry"."size" IS 'Kích thước file';
            COMMENT ON COLUMN "public"."file_entry"."folder_id" IS 'Id folder lưu file';

            -- ----------------------------
            -- Table structure for folder_entry
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."folder_entry";
            CREATE TABLE "public"."folder_entry" (
            "id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "created_by" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "created_at" timestamp(6),
            "last_modified_by" varchar(50) COLLATE "pg_catalog"."default",
            "last_modified_at" timestamp(6),
            "description" varchar(500) COLLATE "pg_catalog"."default",
            "file_count" int4,
            "name" varchar(50) COLLATE "pg_catalog"."default",
            "parent_folder_id" int8
            )
            ;
            COMMENT ON COLUMN "public"."folder_entry"."id" IS 'Bảng lưu thông tin folder chứa file upload';
            COMMENT ON COLUMN "public"."folder_entry"."file_count" IS 'Số file trong folder, nếu đạt tối đa thì cần tạo thư mục mới';
            COMMENT ON COLUMN "public"."folder_entry"."name" IS 'Tên thư mục';
            COMMENT ON COLUMN "public"."folder_entry"."parent_folder_id" IS 'Thư mục cha';

            -- ----------------------------
            -- Table structure for persistent_audit_event
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."persistent_audit_event";
            CREATE TABLE "public"."persistent_audit_event" (
            "event_id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "event_date" timestamp(6),
            "event_type" varchar(255) COLLATE "pg_catalog"."default",
            "principal" varchar(255) COLLATE "pg_catalog"."default" NOT NULL
            )
            ;

            -- ----------------------------
            -- Table structure for persistent_audit_evt_data
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."persistent_audit_evt_data";
            CREATE TABLE "public"."persistent_audit_evt_data" (
            "event_id" int8 NOT NULL,
            "value" varchar(255) COLLATE "pg_catalog"."default",
            "name" varchar(255) COLLATE "pg_catalog"."default" NOT NULL
            )
            ;

            -- ----------------------------
            -- Table structure for privilege
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."privilege";
            CREATE TABLE "public"."privilege" (
            "id" int8 NOT NULL,
            "description" varchar(255) COLLATE "pg_catalog"."default",
            "name" varchar(255) COLLATE "pg_catalog"."default"
            )
            ;

            -- ----------------------------
            -- Records of privilege
            -- ----------------------------
            INSERT INTO "public"."privilege" VALUES (1, 'Quyền vào chức năng Quản lý người dùng', 'VIEW_USER');
            INSERT INTO "public"."privilege" VALUES (2, 'Quyền thêm mới người dùng', 'ADD_USER');
            INSERT INTO "public"."privilege" VALUES (3, 'Quyền cập nhật thông tin người dùng', 'EDIT_USER');
            INSERT INTO "public"."privilege" VALUES (4, 'Quyền xóa người dùng', 'DELETE_USER');

            -- ----------------------------
            -- Table structure for role
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."role";
            CREATE TABLE "public"."role" (
            "id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "created_by" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "created_at" timestamp(6),
            "last_modified_by" varchar(50) COLLATE "pg_catalog"."default",
            "last_modified_at" timestamp(6),
            "description" varchar(255) COLLATE "pg_catalog"."default",
            "name" varchar(255) COLLATE "pg_catalog"."default",
            "status" int4 DEFAULT 1
            )
            ;

            -- ----------------------------
            -- Records of role
            -- ----------------------------
            INSERT INTO "public"."role" VALUES (1, 'superadmin', '2021-06-23 10:38:32', '2021-06-23 10:38:32', '2021-06-23 10:38:32',
            'Administrator', 'SUPERADMIN', 1);
            INSERT INTO "public"."role" VALUES (2, 'superadmin', '2021-06-23 10:38:32', '2021-06-23 10:38:32', '2021-06-23 10:38:32',
            'SubAdmin', 'ADMIN', 1);
            INSERT INTO "public"."role" VALUES (3, 'superadmin', '2021-06-23 10:38:32', '2021-06-23 10:38:32', '2021-06-23 10:38:32',
            'Người dùng hệ thống', 'USER', 1);

            -- ----------------------------
            -- Table structure for roles_privileges
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."roles_privileges";
            CREATE TABLE "public"."roles_privileges" (
            "role_id" int8 NOT NULL,
            "privilege_id" int8 NOT NULL
            )
            ;

            -- ----------------------------
            -- Records of roles_privileges
            -- ----------------------------
            INSERT INTO "public"."roles_privileges" VALUES (1, 1);
            INSERT INTO "public"."roles_privileges" VALUES (1, 2);
            INSERT INTO "public"."roles_privileges" VALUES (1, 3);
            INSERT INTO "public"."roles_privileges" VALUES (1, 4);

            -- ----------------------------
            -- Table structure for user_
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."user_";
            CREATE TABLE "public"."user_" (
            "id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "created_by" varchar(50) COLLATE "pg_catalog"."default" NOT NULL,
            "created_at" timestamp(6),
            "last_modified_by" varchar(50) COLLATE "pg_catalog"."default",
            "last_modified_at" timestamp(6),
            "date_of_birth" timestamp(6),
            "description" varchar(255) COLLATE "pg_catalog"."default",
            "email" varchar(254) COLLATE "pg_catalog"."default",
            "fullname" varchar(200) COLLATE "pg_catalog"."default",
            "password" varchar(100) COLLATE "pg_catalog"."default" NOT NULL,
            "phone_number" varchar(50) COLLATE "pg_catalog"."default",
            "role_updatable" int4 DEFAULT 1,
            "status" int4 DEFAULT 1,
            "username" varchar(50) COLLATE "pg_catalog"."default" NOT NULL
            )
            ;

            -- ----------------------------
            -- Records of user_
            -- ----------------------------
            INSERT INTO "public"."user_" VALUES (1, '0', NULL, NULL, NULL, NULL, NULL, 'superadmin@email.com', 'Super Admin',
            '$2a$11$ly3HQ3E2eryp1jUKX7C77uLveflgxmEDnfFUW0NH4IgnrutSiutRS', NULL, 0, 1, 'superadmin');

            -- ----------------------------
            -- Table structure for user_login
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."user_login";
            CREATE TABLE "public"."user_login" (
            "id" int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY (
            INCREMENT 1
            MINVALUE 1
            MAXVALUE 9223372036854775807
            START 1
            ),
            "ip" varchar(75) COLLATE "pg_catalog"."default",
            "login_time" timestamp(6),
            "success" bool,
            "username" varchar(75) COLLATE "pg_catalog"."default",
            "description" varchar(255) COLLATE "pg_catalog"."default"
            )
            ;

            -- ----------------------------
            -- Table structure for user_roles
            -- ----------------------------
            DROP TABLE IF EXISTS "public"."user_roles";
            CREATE TABLE "public"."user_roles" (
            "user_id" int8 NOT NULL,
            "role_id" int8 NOT NULL
            )
            ;

            -- ----------------------------
            -- Records of user_roles
            -- ----------------------------
            INSERT INTO "public"."user_roles" VALUES (1, 1);

            -- ----------------------------
            -- Uniques structure for table access_token
            -- ----------------------------
            ALTER TABLE "public"."access_token" ADD CONSTRAINT "uc_access_tokenusername_col" UNIQUE ("username", "token");

            -- ----------------------------
            -- Primary Key structure for table access_token
            -- ----------------------------
            ALTER TABLE "public"."access_token" ADD CONSTRAINT "access_tokenPK" PRIMARY KEY ("token");

            -- ----------------------------
            -- Primary Key structure for table file_entry
            -- ----------------------------
            ALTER TABLE "public"."file_entry" ADD CONSTRAINT "file_entryPK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table folder_entry
            -- ----------------------------
            ALTER TABLE "public"."folder_entry" ADD CONSTRAINT "folder_entryPK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table persistent_audit_event
            -- ----------------------------
            ALTER TABLE "public"."persistent_audit_event" ADD CONSTRAINT "persistent_audit_eventPK" PRIMARY KEY ("event_id");

            -- ----------------------------
            -- Primary Key structure for table persistent_audit_evt_data
            -- ----------------------------
            ALTER TABLE "public"."persistent_audit_evt_data" ADD CONSTRAINT "persistent_audit_evt_data_pkey" PRIMARY KEY ("event_id",
            "name");

            -- ----------------------------
            -- Primary Key structure for table privilege
            -- ----------------------------
            ALTER TABLE "public"."privilege" ADD CONSTRAINT "privilegePK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table role
            -- ----------------------------
            ALTER TABLE "public"."role" ADD CONSTRAINT "rolePK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table roles_privileges
            -- ----------------------------
            ALTER TABLE "public"."roles_privileges" ADD CONSTRAINT "roles_privileges_pkey" PRIMARY KEY ("role_id", "privilege_id");

            -- ----------------------------
            -- Uniques structure for table user_
            -- ----------------------------
            ALTER TABLE "public"."user_" ADD CONSTRAINT "uc_usersemail_col" UNIQUE ("email");
            ALTER TABLE "public"."user_" ADD CONSTRAINT "uc_usersusername_col" UNIQUE ("username");

            -- ----------------------------
            -- Primary Key structure for table user_
            -- ----------------------------
            ALTER TABLE "public"."user_" ADD CONSTRAINT "usersPK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table user_login
            -- ----------------------------
            ALTER TABLE "public"."user_login" ADD CONSTRAINT "user_loginPK" PRIMARY KEY ("id");

            -- ----------------------------
            -- Primary Key structure for table user_roles
            -- ----------------------------
            ALTER TABLE "public"."user_roles" ADD CONSTRAINT "user_roles_pkey" PRIMARY KEY ("user_id", "role_id");

            -- ----------------------------
            -- Foreign Keys structure for table file_entry
            -- ----------------------------
            ALTER TABLE "public"."file_entry" ADD CONSTRAINT "FKtnwhewiahwtqhciraf8596102" FOREIGN KEY ("folder_id") REFERENCES
            "public"."folder_entry" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

            -- ----------------------------
            -- Foreign Keys structure for table folder_entry
            -- ----------------------------
            ALTER TABLE "public"."folder_entry" ADD CONSTRAINT "FK8s6ok3i7war9g62tuh0fn08c7" FOREIGN KEY ("parent_folder_id")
            REFERENCES "public"."folder_entry" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

            -- ----------------------------
            -- Foreign Keys structure for table persistent_audit_evt_data
            -- ----------------------------
            ALTER TABLE "public"."persistent_audit_evt_data" ADD CONSTRAINT "FK9ynvwlu7w4uqpjlxvk9kiscqs" FOREIGN KEY ("event_id")
            REFERENCES "public"."persistent_audit_event" ("event_id") ON DELETE NO ACTION ON UPDATE NO ACTION;

            -- ----------------------------
            -- Foreign Keys structure for table roles_privileges
            -- ----------------------------
            ALTER TABLE "public"."roles_privileges" ADD CONSTRAINT "FK5yjwxw2gvfyu76j3rgqwo685u" FOREIGN KEY ("privilege_id")
            REFERENCES "public"."privilege" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;
            ALTER TABLE "public"."roles_privileges" ADD CONSTRAINT "FK9h2vewsqh8luhfq71xokh4who" FOREIGN KEY ("role_id") REFERENCES
            "public"."role" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

            -- ----------------------------
            -- Foreign Keys structure for table user_roles
            -- ----------------------------
            ALTER TABLE "public"."user_roles" ADD CONSTRAINT "FKhfh9dx7w3ubf1co1vdev94g3f" FOREIGN KEY ("user_id") REFERENCES
            "public"."user_" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;
            ALTER TABLE "public"."user_roles" ADD CONSTRAINT "FKrhfovtciq1l558cw6udg0h0d3" FOREIGN KEY ("role_id") REFERENCES
            "public"."role" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;
        </sql>
    </changeSet>
</databaseChangeLog>
